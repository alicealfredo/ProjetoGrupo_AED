<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/styleDashboard.css">
    <title>Painel Admin</title>
</head>
<body style="background-color: #fff7c8;">
    <header>
        <nav class="navbar  fixed-top">
            <div class="container-fluid">
                <a href="{{ url_for('index') }}">Home</a>
                <a href="{{ url_for('dashboard') }}">Dashboard</a>
                <a href="{{ url_for('categorias') }}">Categorias</a>
                
                {% if session.get('user') %}
                    {% if session['user']['email'] == 'admin@gmail.com' %}
                        <a href="{{ url_for('admin') }}">Painel Admin</a>
                    {% else %}
                        <a href="{{ url_for('perfil') }}">Perfil</a>
                    {% endif %}
                    <a href="{{ url_for('logout') }}">Sair</a>
                {% else %}
                    <a href="{{ url_for('login') }}">Login</a>
                {% endif %}
                <form class="search-box" method="GET">
                    <input type="text" name="search" placeholder="Pesquise fotos e ilustrações" value="{{ search }}">
                    <button type="submit" class="search-btn">
                        <img src="{{ url_for('static', filename='imagens/icons/search.svg') }}">
                    </button>
                </form>
            </div>
        </nav>
    </header>

    <main class="container mt-5 pt-5">
        <h2 class="mb-4" style="color: #540B0E;">Gestão do Sistema</h2>
        
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card p-3 text-center" style="background-color: #F4D35E; border: none; border-radius: 15px;">
                    <h4>{{ stats.total_users }}</h4>
                    <p>Utilizadores</p>
                </div> 
            </div>
            <div class="col-md-6">
                <div class="card p-3 text-center" style="background-color: #540B0E; color: #F4D35E; border: none; border-radius: 15px;">
                    <h4>{{ stats.total_photos }}</h4>
                    <p>Fotos Totais</p>
                </div>
            </div>
        </div>

        <div class="card p-4 shadow-sm border-0 mb-5" style="border-radius: 15px;">
            <h4 class="mb-3">Utilizadores Registados</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Email</th>
                        <th>Ação</th>
                    </tr>
                </thead>
                <tbody>
                    {% for u in users %}
                    <tr>
                        <td>{{ u.nome }}</td>
                        <td>{{ u.email }}</td>
                        <td>
                            {% if u.email != 'admin@gmail.com' %}
                            <a href="{{ url_for('banir_utilizador', email=u.email) }}" class="text-danger small">Banir</a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <h4 class="mb-3">Moderação de Conteúdo</h4>
        <div class="row row-cols-1 row-cols-md-3 g-3">
            {% for foto in photos %}
            <div class="col">
                <div class="card h-100 border-0 shadow-sm">
                    <img src="{{ foto.url }}" class="card-img-top" style="height: 120px; object-fit: cover;">
                    <div class="card-body p-2">
                        <p class="small mb-1"><strong>{{ foto.autor }}</strong></p>
                        <a href="{{ url_for('remover_upload', url=foto.url) }}" class="btn btn-sm btn-danger w-100">Remover</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </main>
</body>
</html>